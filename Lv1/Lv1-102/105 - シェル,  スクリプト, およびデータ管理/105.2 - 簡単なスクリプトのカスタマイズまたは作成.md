# LinuC Lv1-102
## 105.2 シェル, スクリプト, およびデータ管理 - `簡単なスクリプトのカスタマイズまたは作成` ★★★★☆
> 既存のスクリプトをカスタマイズしたり, 簡単なBashスクリプトを新規作成できる.
---
### <span style="color: red; ">**`コマンド置換機能`**</span>
- 書式
    ```sh
    `実行コマンド`（バッククォート, 日本語キーボードではSHIFT+@）
    または
    $(実行コマンド)
    ```

</br>

### <span style="color: red; ">**`シェルスクリプトの特殊変数`**</span>
- 特殊な変数
    | 変数名 | 説明 |
    |:------|:-----|
    | **$0** | **シェルスクリプトファイル**名 |
    | **$n** | **n番目の引数** (10番目以降の場合は {$10} と指定) |
    | **$#** | コマンドラインに与えられた**引数の数** |
    | **$$** | 現在のシェルの**プロセスID** |
    | **$?** | **最後に実行したコマンドの終了ステータス** ( 0 = 正常終了, 1 = 異常終了, それ以外はエラー ） |
    | **$@** | 全ての引数 ( 区切りはスペース ) |
    | **$#** | 全ての引数 ( 区切りは環境変数IFSで指定したもの ) |

</br>

### スクリプト実行に関するコマンド
#### <span style="color: red; ">**`source`**</span>コマンド - スクリプト実行
> 指定した**シェルスクリプトを読み込み, 現在のシェルで実行**する.
>- **実行権が無いシェルスクリプトを実行**する.
- 書式
    ```sh
    source ファイル名もしくはスクリプト名 [引数1] [引数2]・・・
    または
    ./ファイルもしくはスクリプト [引数1] [引数2]・・・
    ```

</br>

#### <span style="color: red; ">**`exec`**</span>コマンド - シェルを引き継いでコマンド実行
> 指定した**コマンドを既存のジョブ(シェルのプロセス)と置き換えて実行**する.
- 書式
    ```sh
    exec コマンド
    ```

</br>

### シェルスクリプトの制御構造
#### <span style="color: red; ">**`test`**</span>コマンド - 条件式の真偽を判定
- ファイルの形式に関する条件式
    | 条件式 | 意味 | 実行結果 |
    |:------:|:-----|:---------|
    | **-d ディレクトリ(パス)名** | directory | 指定した**ディレクトリがあれば**真 |
    | **-f ファイル(パス)名** | file | 指定したファイルが**通常ファイルであり, 存在**すれば真 |
    | **-e ファイル(パス)名** | equal | 指定した**ファイルが存在すれば**真 |
    | **-r ファイル(パス)名** | read | 指定したファイルが**存在, かつ読み込み可能**であれば真 |
    | **-w ファイル(パス)名** | write | 指定したファイルが**存在, かつ書き込み可能**であれば真 |
    | **-x ファイル(パス)名** | exec | 指定したファイルが**存在, かつ実行可能**であれば真 |

- ファイルの特性に関する条件式　
    | 条件式 | 意味 | 実行結果 |
    |:------:|:-----|:---------|
    | **ファイル1 -nt ファイル2** | newer than | ファイル1の更新日付が, ファイル2よりも**新しければ**真 |
    | **ファイル1 -ot ファイル2** | older than | ファイル1の更新日付が, ファイル2よりも**古ければ**真 |

- 文字列(STR) に関する条件式
    | 条件式 | 意味 | 実行結果 |
    |:------:|:-----|:---------|
    | **-z 文字列** | zero | 文字列の**長さが 0** であれば真 |
    | **-n 文字列** | not zero | 文字列の**長さが 0 より大きければ**真 |
    | **文字列1 = 文字列2** |  | 文字列1と文字列2が**等しければ**真 |
    | **文字列1 != 文字列2** |  | 文字列1と文字列2が**等しくなければ**真 |

- 数値(NUM) に関する条件式
    | 条件式 | 意味 | 実行結果 |
    |:------:|:-----|:---------|
    | **数値1 -eq 数値2** | equal | 数値1と数値2が**等しければ**真 |
    | **数値1 -ne 数値2** | not equal | 数値1と数値2が**等しくなければ**真 |
    | **数値1 -ge 数値2** | greater than or equal | 数値1が数値2よりも**大きい, または等しければ**真 |
    | **数値1 -gt 数値2** | greater than | 数値1が数値2よりも大きければ真 |
    | **数値1 -le 数値2** | less than or equal | 数値1が数値2よりも**小さい, または等しければ**真 |
    | **数値1 -lt 数値2** | less than | 数値1が数値2よりも**小さければ**真 |

- 論理結合に関する条件式
    | 条件式 | 意味 | 実行結果 |
    |:------:|:-----|:---------|
    | **!条件** |  | 条件式が偽であれば真 |
    | **条件1 -a 条件2** | and | 条件1と条件2の両方の条件式が真であれば真 |
    | **条件1 -o 条件2** | or | 条件1と条件2のどちらかの条件式が真であれば真 |

</br>

#### <span style="color: red; ">**`read`**</span>コマンド - ファイルの読み取り
>
>- **変数には$がつかない**ことに注意.
- 書式
    ```sh
    read [オプション] [ファイル名]
    ```
- readの**引数からあふれた分は最後にすべて格納**される.
    ```sh
    read a b c < A B C D E F
    ```
    - 実行結果として a="A",b="B",c="C D E F"

</br>

#### <span style="color: red; ">**`seq`**</span>コマンド - 連続した数字列の生成
> **単調増加（減少）する連続した数値**を作成する.
- 書式
    ```sh
    seq 開始数値 終了数値

    seq 終了数値 (1から開始)

    seq 開始する数値 増加する値 終了する数値
    ```

</br>

#### <span style="color: red; ">**`if`**</span>文 - 条件分岐
> 条件文に記述された**コマンドの終了ステータスを条件分岐**に使用.
- 書式
    ```sh
    if 条件式
        then
            (条件式が真のときの処理)
        else
            (条件式が偽のときの処理)
    fi
    ```
    
</br>

#### <span style="color: red; ">**`case`**</span>文 - 条件分岐
> 値とパターンを照合し, **パターンに一致するとそのパターンに指定されている実行文を処理**.
- 書式
    ```sh
    case スイッチ値 in
        パターン1)     (スイッチ値=パターン1のときの処理);;
        パターン2)     (スイッチ値=パターン2のときの処理);;
        ...
    esac
    ```
</br>

#### <span style="color: red; ">**`for`**</span>文 - 繰り返し処理
> シェルスクリプトにおいて**繰り返し処理**を行う.
- 書式
    ```sh
    for 変数名 in 変数名に代入するリスト
    do
        (処理)
    done
    ```

</br>

#### <span style="color: red; ">**`while`**</span>文 - 繰り返し処理
> **条件文に記述されたコマンドの終了ステータスを使用し, 繰り返し処理を継続するか終了するかを判定**.
- 書式
    ```sh
    while 条件文
    do
        (処理)
    done
    ```

</br>

### スクリプトインタプリタの設定
#### <span style="color: red; ">**`スクリプトを解釈して実行するプログラムの設定を行う`**</span>
> スクリプトファイルの1行目には**そのファイルがどのようなインタープリタ（シェル）で実行されるかを記述**.
- 書式
    ```sh
    #!インタープリタ
    ```
    - **`#!`はシェバング(shebang)** で, `#!`が記述された行のことをシェバング行という.

        - 例えば, bashシェルなら先頭に`#!/bin/bash`をつける.