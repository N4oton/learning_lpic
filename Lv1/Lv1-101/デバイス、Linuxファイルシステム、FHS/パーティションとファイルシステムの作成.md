# LinuC Lv1-101
## デバイス、Linuxファイルシステム、FHS - `パーティションとファイルシステムの作成`
---
### <span style="color: red; ">**`parted`**</span>コマンド
- 新しいハードディスクにパーティションを作成.
- MBR形式、GPT形式のパーティションテーブルをサポート.
- 新しいハードディスクへのパーティションの作成手順
    1. パーティションテーブルの指定
        - **mklabel** サブコマンドで、パーティションテーブルの方式を指定。未指定の場合MBR形式として動作。
        - mklabel サブコマンドの書式
            ```sh
            (parted) mklabel [ パーティションテーブル ]
            ```

        - MBR形式を明示的に指定するには、msdosを指定します。
            ```sh
            (parted) mklabel msdos
            ```

    2. パーティションの作成
        - **mkpart** サブコマンドで、パーティションを作成。
        - mkpartサブコマンドの書式
            ```sh
            (parted) mkpart [ パーティションタイプ ファイルシステム種別 パーティション名 ] 開始位置 終了位置
            ```
        - パーティションタイプはMBR形式で指定可能で、primary（基本）、extended（拡張）、logical（論理）を指定。
        - 先頭にext4ファイルシステムとして利用する一つの1000MBの基本パーティションを作成するには、以下のように指定。
            ```sh
            (parted) mkpart primary ext4 1 1000MB
            ```

### <span style="color: red; ">**`ファイルシステム`**</span>
- Linuxで主に使用されるファイルシステム
    | ファイルシステム | 説明 |
    |:----------|:-----|
    | ext2 | 以前のLinux標準規格 |
    | ext3 | ext2後継 (ジャーナリングファイルシステム) |
    | ext4 | ext3後継 (ジャーナリングファイルシステム) |
    | XFS | SGI開発. (ジャーナリングファイルシステム, 動的inode) |
    | JFS | IBM開発. (ジャーナリングファイルシステム, 動的inode) |
    | ReiserFX | Hans Reiser氏開発. (ジャーナリングファイルシステム, 動的inode) |
- 次世代のLinux標準ファイルシステムとして開発されているファイルシステム ... **`Btrfs`**

### <span style="color: red; ">**`fdisk`**</span>(format disk)
MBR形式のハードディスクのパーティションの作成、削除、変更などを行う.
- 書式
    ```sh
    fdisk [-l] デバイス名
    ```
    - `-l`オプション ... 指定したデバイスのパーティションテーブルを表示
    - オプション省略では対話的操作が可能.

- 主なサブコマンド
    | サブコマンド | 説明 |
    |:----------|:-----|
    | m | サブコマンドのメニューの表示 |
    | l | パーティションタイプの一覧表示 |
    | n | パーティションの作成 |
    | d | パーティションの削除 |
    | p | パーティションテーブルの表示 |
    | t | パーティションタイプの変更 |
    | w | パーティションテーブルの変更を保存し終了 |
    | q | パーティションテーブルの変更を保存せずに終了 |

### <span style="color: red; ">**`gdisk`**</span>
- GPT形式のハードディスクのパーティションの作成、削除、変更などを行う.

### <span style="color: red; ">**`mkfs`**</span>(make filesystem)
- Linuxのファイルシステムを構築.
- 書式
    ```sh
    mkfs [オプション] デバイス名
    ```
    - デフォルト(オプションなし)ではext2ファイルシステムを作成.
- オプション
    | オプション | 説明 |
    |:----------|:-----|
    | -t ファイルシステム | ファイルシステムの種類の指定 ( ext2、ext3、ext4 ) |
    | -c | 実行前の不良ブロックの検査 |

### <span style="color: red; ">**`mke2fs`**</span>(make ext2 filesystem)
- ext2/ext3/ext4ファイルシステムの作成を行う.
- 書式
    ```sh
    mke2fs [オプション] デバイス名
    ```
- オプション
    | オプション | 説明 |
    |:----------|:-----|
    | -j | ext3のファイルシステムの作成 |
    | -t ファイルシステム | ファイルシステムの種類の指定 ( ext2、ext3、ext4 ) |
    | -c | 実行前の不良ブロックの検査 |

### <span style="color: red; ">**`mkswap`**</span>(make swap)
- スワップ領域を作成.
- 手順
    1. スワップ用のパーティションを用意する
    2. mkswap コマンドでスワップ領域を作成
    3. swapon コマンドでスワップ領域を有効化
    4. （不要になれば）swapoff コマンドでスワップ領域を無効化
#### <span style="color: red; ">**`swapon`**</span>
- スワップ領域を有効にする
#### <span style="color: red; ">**`swapoff`**</span>
- スワップ領域を無効にする

### <span style="color: red; ">**`MBR方式のハードディスク`**</span>
- 基本パーティションは最大4つ作成.
- それ以上の数に分割するには基本パーティションを拡張パーティションとして割り当て、パーティションをさらに論理（Logical）パーティションに分割.
    - 論理パーティションは作成された基本パーティションの数に関わらず、5番目のパーティションからの表記.

### <span style="color: red; ">**`GPT`**</span>(GUID Partition Table)
- MBR（Master Boot Record）形式のパーティションテーブルにあった制約を克服.
- GPTに存在しない制約
    - 基本パーティション数：4
    - ハードディスク容量：2TB
    - 起動用システムファームウェア：BIOS

### <span style="color: red; ">**`IDE接続のハードディスク`**</span>
- 対応するデバイスファイル
    | デバイスファイル | 説明 |
    |:----------|:-----|
    | /dev/hda | プライマリのマスター（1番目のディスク） |
    | /dev/hdb | プライマリのスレーブ（2番目のディスク） |
    | /dev/hdc | セカンダリのマスター（3番目のディスク） |
    | /dev/hdd | セカンダリのスレーブ（4番目のディスク） |
- 各ディスクのパーティションの番号 (ex. `/dev/hda`ディスク)
    | デバイスファイル | 説明 |
    |:----------|:-----|
    | /dev/hda1 | 1番目のパーティション |
    | /dev/hda2 | 2番目のパーティション |
    | /dev/hda3 | 3番目のパーティション |

### <span style="color: red; ">**`SCSI接続のハードディスク`**</span>
- 対応するデバイスファイル
    | デバイスファイル | 説明 |
    |:----------|:-----|
    | /dev/sda | 1番目のディスク |
    | /dev/sdb | 2番目のディスク |
    | /dev/sdc | 3番目のディスク |
    | /dev/sdd | 4番目のディスク |
- 各ディスクのパーティションの番号 (ex. `/dev/sdc`ディスク)
    | デバイスファイル | 説明 |
    |:----------|:-----|
    | /dev/sdc1 | 1番目のパーティション |
    | /dev/sdc2 | 2番目のパーティション |
    | /dev/sdc3 | 3番目のパーティション |