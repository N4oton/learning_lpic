# LinuC Lv1-102
## 109.1 ネットワークの基礎 - `インターネットプロトコルの基礎` ★★★★☆
---
### <span style="color: red; ">**`通信プロトコル`**</span>
#### <span style="color: red; ">**`IP`**</span>
- インターネット**通信プロトコルの中核**をなす.
- ネットワーク**機器へのアドレス付与**や, **パケットの分割や統合**を行う機能を持つプロトコル.
#### <span style="color: red; ">**`TCP`**</span>
- **パケットの再送, 到達確認の制御**を行う**信頼性の高いコネクション型**のプロトコル.
#### <span style="color: red; ">**`UDP`**</span>
- 複雑な制御をしない分**TCPと比べデータ転送が早いコネクションレス型**のプロトコル.
#### <span style="color: red; ">**`ICMP`**</span>
- パケットが到達できなかった場合の**エラーメッセージや, 制御メッセージを通知する**プロトコル.
#### <span style="color: red; ">**`ARP`**</span>
- **IPアドレスからMACアドレスを求める**プロトコル.
#### <span style="color: red; ">**`IPv4`**</span>
- 特徴
    - ローカルネットワークでのみ使用が許可されている「プライベートアドレス」.
    - インターネット上で使用される世界で唯一の「グローバルアドレス」.
    - 宛先アドレスに32bit使用.
#### <span style="color: red; ">**`IPv4アドレスクラス`**</span>
- クラス
    | クラス | 範囲 | サブネットマスク | 用途 |
    |:-----:|:-----:|:---------------:|:---:|
    | A | 0.0.0.0 - 127.255.255.255 | 255.0.0.0 | 大規模 |
    | B | 128.0.0.0 - 191.255.255.255 | 255.255.0.0 | 中規模 |
    | C | 192.0.0.0 - 223.255.255.255 | 255.255.255.0 | 小規模 |
    | D | 224.0.0.0 - 239.255.255.255 |  | マルチキャスト |
    | E | 240.0.0.0 - 255.255.255.255 |  | 実験用 |
#### <span style="color: red; ">**`プライベートアドレス`**</span>
- IPアドレスのうち, ローカルネットワークでのみ使用が許可されているアドレス.
- 範囲
    | クラス | 範囲 |
    |:-----:|:-----:|
    | A | **10.0**.0.0 - 10.255.255.255 |
    | B | **172.16**.0.0 - 172.31.255.255 |
    | C | **192.168**.0.0 - 192.168.255.255 |
#### <span style="color: red; ">**`CIDR (Classless InterDomain Routing)`**</span>
- IPネットワークの経路情報を集約する際に**クラスの概念をなくした技術**.
- 192.168.0.224/27のように**サブネットマスクを自由な長さで区切る事が出来る**.
#### IPアドレス計算
- ex.)192.168.0.224/27の場合
    ```math
    サブネットマスク/27=ネットワークアドレス部に27bit使用. 
    よって, ホスト部に使用できるのは32-27の5bit.
    5bitでは2^5=32個になる.
    このうち, ネットワークアドレスと, ブロードキャストアドレスを引いた32-2=30個が正解.
    ```
#### <span style="color: red; ">**`IPv6`**</span>
- IPv4に変わる次世代版のインターネットプロトコル.
- IPv4では32bitの長さで表していたIPアドレスをIPv6では128bitで表す.
- 前半64bitが「**サブネットプレフィックス**」, 後半64bitが「**インタフェース識別子**（Interface-ID）」によって構成.
- 表記ルール
    - **16進数**（0-9とA-F）で表記し、全体128bitを**16bitずつ「:」で区切る**（計8ブロック）
    - 各**ブロックの先頭にある「0」は省略可能**（連続した場合も同様）
    - **「0000」は「0」に省略可能**
    - **連続した「0000」のブロックは***1回に限り*, **「::」に省略可能**
- 表記例
    ```sh
        通常表記    2001: 00D3: 0000: 0000: 02AB: 0011: FE25: 8B5D

        省略表記    2001: D3 :: 2AB: 11: FE25: 8B5D
    ```

</br>

### <span style="color: red; ">**`ポート番号`**</span>
- ポート番号は16ビットで表され, **0 - 65535番**までが使用できる.
- その中で, 主要なサービスのポート番号の**ウェルノウンポートはroot権限が必要であり、ユーザー権限では使えません**.
- 割当
    | 種類 | 範囲 | 説明 |
    |:----:|:----:|:----|
    | **Well Known Port Number** (ウェルノウンポート) | 0 - 1023 | システムやroot権限を持つプロセスに割り当てられたポート番号 |
    | **Registered Port Number** (レジスタードポート) | 1024 - 49151 | よく使われるプログラムに割り当てられたポート番号 |
    | **Dynamic Port Number** (ダイナミックポート) | 49152 - 65535 | 自由に使用可能なポート |
- 割当範囲
    - Well Known Ports
        - 0000 0000 0000 0000 - 0000 0011 1111 1111 (10ビット(2^10=1024個))
    - Registered Ports 
        - 0000 0100 0000 0000 - 1011 1111 1111 1111 (ウェルノウンポートとプライベートポートの間)
    - Dynamic Ports
        - 1100 0000 0000 0000 - 1111 1111 1111 1111 (先頭が2進数で11となる数字)
#### <span style="color: red; ">**`Well Known Ports`**</span>
- 代表的なウェルノウンポート
    | ポート番号 | プロトコル | TCP/UDP | 用途 |
    | :--|:----|:----|:----------|
    | **20** | FTP | TCP | ファイル転送 (データ用) |
    | **21** | FTP | TCP | ファイル転送 (制御用) |
    | **22** | SSH | TCP | リモートログイン (暗号化有り) |
    | **23** | TELNET | TCP | リモートログイン (暗号化無し) |
    | **25** | SMTP | TCP | 電子メール送信 |
    | **53** | DNS | TCP/UDP | 名前解決 |
    | **80** | HTTP | TCP | HTMLファイル転送 (暗号化なし) |
    | **110** | POP3 | TCP | 電子メール受信 |
    | **143** | IMAP | TCP | 電子メール受信 |
    | **443** | HTTPS | TCP | HTMLファイル転送 (暗号化有り) |

</br>

### <span style="color: red; ">**`ネットワーク関連の設定ファイル`**</span>
- ネットワーク関連の設定ファイル
    | ファイル名 | 設定内容 | 表示例 |
    |:----------|:---------|:------|
    | **/etc/hostname** | ホスト名を設定 (Debian系) | `# cat /etc/hostname` |
    |               |                          | Debian              |
    |  |  |  |
    | **/etc/sysconfig/network** | ホスト名を設定 (Red Hat系) | `# cat /etc/sysconfig/network` |
    |                        | ネットワーク機能の有効/無効や | NETWORKNG=yes              |
    |                        | デフォルトゲートウェイ等も設定可 | HOSTNAME=CentOS         |
    |                        |                               | GATEWAY=192.168.1.1     |
    |  |  |  |
    | **/etc/hosts** | IPアドレスとホスト名の対応付け | `# cat /etc/hosts` |
    |            |                              | 112.78.124.10 ping-t.com |
    |            |                              | 192.168.1.100 FileServer |
    |  |  |  |
    | **/etc/nsswitch.conf** | 名前解決やサービス名解決の際の | `# cat /etc/nsswitch.conf` |
    |                    | 問い合わせ順序を指定          | hosts:     files dns     |
    |                    |                              | services: files         |
    |  |  |  |
    | **/etc/host.conf** | 名前解決の際の問い合わせ順序を指定 | `# cat /etc/host.conf` |
    |                | 古いライブラリ利用時のみ参照      | order hosts,bind     |
    |  |  |  |
    | **/etc/resolv.conf** | ドメイン名やDNSサーバの指定 | `# cat /etc/resolv.conf` |
    |                  |                           | domain ping-t.com      |
    |                  |                           | nameserver 192.168.1.1 |
    |  |  |  |
    | **/etc/services** | **サービス名とポート番号の対応付け** | `# cat /etc/services` |
    |                  |                           | telnet 23/tcp            |